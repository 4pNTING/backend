syntax = "proto3";

package auth;

service AuthService {
  // Login: เช็ค Username/Password -> บันทึกเวลาเข้า -> คืนค่า User info
  rpc Login (LoginRequest) returns (LoginResponse);
  
  // Logout: ส่ง User UID -> บันทึกเวลาออก
  rpc Logout (LogoutRequest) returns (ActionResponse);

  // ดูประวัติ (สำหรับผู้จัดการ)
  rpc GetAccessLogs (GetLogsRequest) returns (AccessLogListResponse);
}

message LoginRequest {
  string username = 1;
  string password = 2; // เปลี่ยนจาก PIN เป็น Password
}

message LoginResponse {
  bool success = 1;
  string user_uid = 2;
  string role = 3;     // MANAGER, STAFF
  string message = 4;
}

message LogoutRequest {
  string user_uid = 1;
}

message ActionResponse {
  bool success = 1;
  string message = 2;
}

message GetLogsRequest {
  string date = 1; // Optional: "2024-01-01"
}

message AccessLogListResponse {
  repeated AccessLogItem logs = 1;
}

message AccessLogItem {
  string user_name = 1;
  string action = 2;
  string timestamp = 3;
}
